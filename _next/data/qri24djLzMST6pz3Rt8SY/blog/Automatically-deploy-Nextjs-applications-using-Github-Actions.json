{"pageProps":{"post":{"title":"使用Github Actions自动打包部署NextJS应用","date":"2023-02-25T00:00:00.000Z","tags":["Git","NextJS"],"draft":false,"summary":"打包部署博客是一个重复机械的劳动，因此我想到使用Github Actions自动化整个流程。","body":{"raw":"\n打包部署博客是一个重复机械的劳动，因此我想到使用 **Github Actions** 自动化整个流程。虽然有各种现成的Actions仓库，但对于第一次使用的我来说还是遇到了一些问题，在此记录一下。\n\n**目标**\n\n- 自动部署NextJS应用到Github Pages\n- 源代码提交在私有仓库中，打包推送到username.github.io公开仓库\n- 私有仓库main分支上的push操作触发action\n\n**创建actions**\n\n在项目根目录中新建`.github/workflows`目录，并新建deploy.yml相应操作代码在该文件中编写，GitHub会执行workflows目录下的所有文件。\n\n![](https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-7290.c04546.webp)\n\n**使用到的Actions仓库**\n\n[actions-gh-pages](https://github.com/peaceiris/actions-gh-pages)\n\n该仓库中包含不同框架项目的使用示例\n\n⭐️ React and Next\n\n```yml\nname: GitHub Pages\n\non:\n  push:\n    branches:\n      - main\n  pull_request:\n\njobs:\n  deploy:\n    runs-on: ubuntu-22.04\n    permissions:\n      contents: write\n    concurrency:\n      group: ${{ github.workflow }}-${{ github.ref }}\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Node\n        uses: actions/setup-node@v3\n        with:\n          node-version: '14'\n\n      - name: Get yarn cache\n        id: yarn-cache\n        run: echo \"YARN_CACHE_DIR=$(yarn cache dir)\" >> \"${GITHUB_OUTPUT}\"\n\n      - name: Cache dependencies\n        uses: actions/cache@v3\n        with:\n          path: ${{ steps.yarn-cache.outputs.YARN_CACHE_DIR }}\n          key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}\n          restore-keys: |\n            ${{ runner.os }}-yarn-\n\n      - run: yarn install --frozen-lockfile\n      - run: yarn build\n      - run: yarn export\n\n      - name: Deploy\n        uses: peaceiris/actions-gh-pages@v3\n        if: ${{ github.ref == 'refs/heads/main' }}\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }}\n          publish_dir: ./out\n```\n上述示例实现打包NextJS应用到运行此action的仓库中，默认推送到gh-pages分支（通过publish_branch选项修改推送分支）。\n\n因此实现推送到其他仓库需要修改部分代码\n\n```yml\n      - name: Deploy\n        uses: peaceiris/actions-gh-pages@v3\n        with:\n          personal_token: ${{ secrets.PERSONAL_TOKEN }}\n          external_repository: username/username.github.io\n          publish_branch: main\n          publish_dir: ./out // 推送该指定目录下的文件\n          commit_message: ${{ github.event.head_commit.message }}\n```\n\n- `personal_token` 个人令牌\n- `external_repository` 其他仓库的地址\n- `publish_dir` 推送该目录下的文件\n- `commit_message` 自定义commit信息\n\n注意`GITHUB TOKEN`没有访问外部存储库的权限。请创建一个个人访问令牌，并将其设置为secrets，如`personal_token: ${{ secrets.PERSONAL_TOKEN }}`。\n\n**创建个人令牌**\n\n- 点击github页面右上角的个人头像，点击Settings\n\n![](https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-6532.3bbea5.webp)\n\n- 点击Developer settings\n\n![](https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-3950.aca4dd.webp)\n\n- 选择页面右下角的Tokens(classic)，点击Generate new token(classic)\n\n![](https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-7333.68b538.webp)\n\n- 填写备注信息，选择有效时长，**勾选repo**，然后点击下方的Generate token按钮，生成token并复制\n\n![](https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-4107.c474f1.webp)\n\n**将生成的个人令牌绑定到项目的secrets**\n\n- 打开运行action的仓库，依次点击Settings->Actions-> New repository secret\n\n![](https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-4506.428fe9.webp)\n\n- Name输入`personal_token`，Secret粘贴生成的个人令牌，点击Add secret\n\n![](https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-7782.8ec4d7.webp)\n\n通过上面的配置，我们就可以在action中通过`${{ secrets.PERSONAL_TOKEN }}`访问到个人令牌\n\n最后将新建的`deploy.yml`文件提交推送到远程仓库，就会自动触发action执行，构建打包我们的NextJS应用并推送到`external_repository`对应仓库的`publish_branch`对应的分支中\n\n可以在仓库的Actions中查看action的执行过程，完成后打开GitHub Pages对应的仓库就能看到新提交的代码\n\n![](https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-6478.66382d.webp)\n\n以上就是本文的全部内容，感谢阅读。","code":"var Component=(()=>{var d=Object.create;var l=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var k=(a,n)=>()=>(n||a((n={exports:{}}).exports,n),n.exports),g=(a,n)=>{for(var s in n)l(a,s,{get:n[s],enumerable:!0})},t=(a,n,s,i)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let c of u(n))!N.call(a,c)&&c!==s&&l(a,c,{get:()=>n[c],enumerable:!(i=h(n,c))||i.enumerable});return a};var y=(a,n,s)=>(s=a!=null?d(m(a)):{},t(n||!a||!a.__esModule?l(s,\"default\",{value:a,enumerable:!0}):s,a)),b=a=>t(l({},\"__esModule\",{value:!0}),a);var r=k((v,o)=>{o.exports=_jsx_runtime});var x={};g(x,{default:()=>f,frontmatter:()=>_});var e=y(r()),_={title:\"\\u4F7F\\u7528Github Actions\\u81EA\\u52A8\\u6253\\u5305\\u90E8\\u7F72NextJS\\u5E94\\u7528\",date:\"2023-02-25\",tags:[\"Git\",\"NextJS\"],draft:!1,summary:\"\\u6253\\u5305\\u90E8\\u7F72\\u535A\\u5BA2\\u662F\\u4E00\\u4E2A\\u91CD\\u590D\\u673A\\u68B0\\u7684\\u52B3\\u52A8\\uFF0C\\u56E0\\u6B64\\u6211\\u60F3\\u5230\\u4F7F\\u7528Github Actions\\u81EA\\u52A8\\u5316\\u6574\\u4E2A\\u6D41\\u7A0B\\u3002\"};function p(a){let n=Object.assign({p:\"p\",strong:\"strong\",ul:\"ul\",li:\"li\",code:\"code\",img:\"img\",a:\"a\",pre:\"pre\",span:\"span\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.p,{children:[\"\\u6253\\u5305\\u90E8\\u7F72\\u535A\\u5BA2\\u662F\\u4E00\\u4E2A\\u91CD\\u590D\\u673A\\u68B0\\u7684\\u52B3\\u52A8\\uFF0C\\u56E0\\u6B64\\u6211\\u60F3\\u5230\\u4F7F\\u7528 \",(0,e.jsx)(n.strong,{children:\"Github Actions\"}),\" \\u81EA\\u52A8\\u5316\\u6574\\u4E2A\\u6D41\\u7A0B\\u3002\\u867D\\u7136\\u6709\\u5404\\u79CD\\u73B0\\u6210\\u7684Actions\\u4ED3\\u5E93\\uFF0C\\u4F46\\u5BF9\\u4E8E\\u7B2C\\u4E00\\u6B21\\u4F7F\\u7528\\u7684\\u6211\\u6765\\u8BF4\\u8FD8\\u662F\\u9047\\u5230\\u4E86\\u4E00\\u4E9B\\u95EE\\u9898\\uFF0C\\u5728\\u6B64\\u8BB0\\u5F55\\u4E00\\u4E0B\\u3002\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"\\u76EE\\u6807\"})}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"\\u81EA\\u52A8\\u90E8\\u7F72NextJS\\u5E94\\u7528\\u5230Github Pages\"}),(0,e.jsx)(n.li,{children:\"\\u6E90\\u4EE3\\u7801\\u63D0\\u4EA4\\u5728\\u79C1\\u6709\\u4ED3\\u5E93\\u4E2D\\uFF0C\\u6253\\u5305\\u63A8\\u9001\\u5230username.github.io\\u516C\\u5F00\\u4ED3\\u5E93\"}),(0,e.jsx)(n.li,{children:\"\\u79C1\\u6709\\u4ED3\\u5E93main\\u5206\\u652F\\u4E0A\\u7684push\\u64CD\\u4F5C\\u89E6\\u53D1action\"})]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"\\u521B\\u5EFAactions\"})}),(0,e.jsxs)(n.p,{children:[\"\\u5728\\u9879\\u76EE\\u6839\\u76EE\\u5F55\\u4E2D\\u65B0\\u5EFA\",(0,e.jsx)(n.code,{children:\".github/workflows\"}),\"\\u76EE\\u5F55\\uFF0C\\u5E76\\u65B0\\u5EFAdeploy.yml\\u76F8\\u5E94\\u64CD\\u4F5C\\u4EE3\\u7801\\u5728\\u8BE5\\u6587\\u4EF6\\u4E2D\\u7F16\\u5199\\uFF0CGitHub\\u4F1A\\u6267\\u884Cworkflows\\u76EE\\u5F55\\u4E0B\\u7684\\u6240\\u6709\\u6587\\u4EF6\\u3002\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"\",src:\"https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-7290.c04546.webp\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"\\u4F7F\\u7528\\u5230\\u7684Actions\\u4ED3\\u5E93\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://github.com/peaceiris/actions-gh-pages\",children:\"actions-gh-pages\"})}),(0,e.jsx)(n.p,{children:\"\\u8BE5\\u4ED3\\u5E93\\u4E2D\\u5305\\u542B\\u4E0D\\u540C\\u6846\\u67B6\\u9879\\u76EE\\u7684\\u4F7F\\u7528\\u793A\\u4F8B\"}),(0,e.jsx)(n.p,{children:\"\\u2B50\\uFE0F React and Next\"}),(0,e.jsx)(n.pre,{className:\"language-yml\",children:(0,e.jsxs)(n.code,{className:\"language-yml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` GitHub Pages\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"on\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"push\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"branches\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` main\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"pull_request\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"jobs\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"deploy\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"runs-on\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" ubuntu\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"22.04\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"permissions\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"contents\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` write\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"concurrency\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"group\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" github.workflow \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"$\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" github.ref \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"steps\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"uses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` actions/checkout@v3\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Setup Node\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"uses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" actions/setup\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`node@v3\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"with\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"node-version\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'14'\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Get yarn cache\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"id\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" yarn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`cache\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),' echo \"YARN_CACHE_DIR=$(yarn cache dir)\" ',(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\">\"}),' \"$',(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"GITHUB_OUTPUT\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\"\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Cache dependencies\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"uses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` actions/cache@v3\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"with\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"path\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" steps.yarn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"cache.outputs.YARN_CACHE_DIR \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"key\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" runner.os \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"yarn\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"$\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" hashFiles('\",(0,e.jsx)(n.span,{className:\"token important\",children:\"**/yarn.lock')\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"restore-keys\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"|\"}),(0,e.jsx)(n.span,{className:\"token string scalar\",children:`\n`})]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token string scalar\",children:\"            ${{ runner.os }}-yarn-\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" yarn install \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"frozen\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`lockfile\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` yarn build\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"run\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` yarn export\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Deploy\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"uses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" peaceiris/actions\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"gh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`pages@v3\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"if\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" github.ref == 'refs/heads/main' \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"with\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"github_token\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" secrets.GITHUB_TOKEN \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"publish_dir\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ./out\n`]})]})}),(0,e.jsx)(n.p,{children:\"\\u4E0A\\u8FF0\\u793A\\u4F8B\\u5B9E\\u73B0\\u6253\\u5305NextJS\\u5E94\\u7528\\u5230\\u8FD0\\u884C\\u6B64action\\u7684\\u4ED3\\u5E93\\u4E2D\\uFF0C\\u9ED8\\u8BA4\\u63A8\\u9001\\u5230gh-pages\\u5206\\u652F\\uFF08\\u901A\\u8FC7publish_branch\\u9009\\u9879\\u4FEE\\u6539\\u63A8\\u9001\\u5206\\u652F\\uFF09\\u3002\"}),(0,e.jsx)(n.p,{children:\"\\u56E0\\u6B64\\u5B9E\\u73B0\\u63A8\\u9001\\u5230\\u5176\\u4ED6\\u4ED3\\u5E93\\u9700\\u8981\\u4FEE\\u6539\\u90E8\\u5206\\u4EE3\\u7801\"}),(0,e.jsx)(n.pre,{className:\"language-yml\",children:(0,e.jsxs)(n.code,{className:\"language-yml code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Deploy\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"uses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" peaceiris/actions\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"gh\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`pages@v3\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"with\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"personal_token\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" secrets.PERSONAL_TOKEN \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"external_repository\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` username/username.github.io\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"publish_branch\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` main\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"publish_dir\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` ./out // \\u63A8\\u9001\\u8BE5\\u6307\\u5B9A\\u76EE\\u5F55\\u4E0B\\u7684\\u6587\\u4EF6\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"commit_message\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" $\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" github.event.head_commit.message \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsxs)(n.ul,{children:[(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"personal_token\"}),\" \\u4E2A\\u4EBA\\u4EE4\\u724C\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"external_repository\"}),\" \\u5176\\u4ED6\\u4ED3\\u5E93\\u7684\\u5730\\u5740\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"publish_dir\"}),\" \\u63A8\\u9001\\u8BE5\\u76EE\\u5F55\\u4E0B\\u7684\\u6587\\u4EF6\"]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.code,{children:\"commit_message\"}),\" \\u81EA\\u5B9A\\u4E49commit\\u4FE1\\u606F\"]})]}),(0,e.jsxs)(n.p,{children:[\"\\u6CE8\\u610F\",(0,e.jsx)(n.code,{children:\"GITHUB TOKEN\"}),\"\\u6CA1\\u6709\\u8BBF\\u95EE\\u5916\\u90E8\\u5B58\\u50A8\\u5E93\\u7684\\u6743\\u9650\\u3002\\u8BF7\\u521B\\u5EFA\\u4E00\\u4E2A\\u4E2A\\u4EBA\\u8BBF\\u95EE\\u4EE4\\u724C\\uFF0C\\u5E76\\u5C06\\u5176\\u8BBE\\u7F6E\\u4E3Asecrets\\uFF0C\\u5982\",(0,e.jsx)(n.code,{children:\"personal_token: ${{ secrets.PERSONAL_TOKEN }}\"}),\"\\u3002\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"\\u521B\\u5EFA\\u4E2A\\u4EBA\\u4EE4\\u724C\"})}),(0,e.jsx)(n.ul,{children:(0,e.jsx)(n.li,{children:\"\\u70B9\\u51FBgithub\\u9875\\u9762\\u53F3\\u4E0A\\u89D2\\u7684\\u4E2A\\u4EBA\\u5934\\u50CF\\uFF0C\\u70B9\\u51FBSettings\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"\",src:\"https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-6532.3bbea5.webp\"})}),(0,e.jsx)(n.ul,{children:(0,e.jsx)(n.li,{children:\"\\u70B9\\u51FBDeveloper settings\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"\",src:\"https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-3950.aca4dd.webp\"})}),(0,e.jsx)(n.ul,{children:(0,e.jsx)(n.li,{children:\"\\u9009\\u62E9\\u9875\\u9762\\u53F3\\u4E0B\\u89D2\\u7684Tokens(classic)\\uFF0C\\u70B9\\u51FBGenerate new token(classic)\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"\",src:\"https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-7333.68b538.webp\"})}),(0,e.jsx)(n.ul,{children:(0,e.jsxs)(n.li,{children:[\"\\u586B\\u5199\\u5907\\u6CE8\\u4FE1\\u606F\\uFF0C\\u9009\\u62E9\\u6709\\u6548\\u65F6\\u957F\\uFF0C\",(0,e.jsx)(n.strong,{children:\"\\u52FE\\u9009repo\"}),\"\\uFF0C\\u7136\\u540E\\u70B9\\u51FB\\u4E0B\\u65B9\\u7684Generate token\\u6309\\u94AE\\uFF0C\\u751F\\u6210token\\u5E76\\u590D\\u5236\"]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"\",src:\"https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-4107.c474f1.webp\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"\\u5C06\\u751F\\u6210\\u7684\\u4E2A\\u4EBA\\u4EE4\\u724C\\u7ED1\\u5B9A\\u5230\\u9879\\u76EE\\u7684secrets\"})}),(0,e.jsx)(n.ul,{children:(0,e.jsx)(n.li,{children:\"\\u6253\\u5F00\\u8FD0\\u884Caction\\u7684\\u4ED3\\u5E93\\uFF0C\\u4F9D\\u6B21\\u70B9\\u51FBSettings->Actions-> New repository secret\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"\",src:\"https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-4506.428fe9.webp\"})}),(0,e.jsx)(n.ul,{children:(0,e.jsxs)(n.li,{children:[\"Name\\u8F93\\u5165\",(0,e.jsx)(n.code,{children:\"personal_token\"}),\"\\uFF0CSecret\\u7C98\\u8D34\\u751F\\u6210\\u7684\\u4E2A\\u4EBA\\u4EE4\\u724C\\uFF0C\\u70B9\\u51FBAdd secret\"]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"\",src:\"https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-7782.8ec4d7.webp\"})}),(0,e.jsxs)(n.p,{children:[\"\\u901A\\u8FC7\\u4E0A\\u9762\\u7684\\u914D\\u7F6E\\uFF0C\\u6211\\u4EEC\\u5C31\\u53EF\\u4EE5\\u5728action\\u4E2D\\u901A\\u8FC7\",(0,e.jsx)(n.code,{children:\"${{ secrets.PERSONAL_TOKEN }}\"}),\"\\u8BBF\\u95EE\\u5230\\u4E2A\\u4EBA\\u4EE4\\u724C\"]}),(0,e.jsxs)(n.p,{children:[\"\\u6700\\u540E\\u5C06\\u65B0\\u5EFA\\u7684\",(0,e.jsx)(n.code,{children:\"deploy.yml\"}),\"\\u6587\\u4EF6\\u63D0\\u4EA4\\u63A8\\u9001\\u5230\\u8FDC\\u7A0B\\u4ED3\\u5E93\\uFF0C\\u5C31\\u4F1A\\u81EA\\u52A8\\u89E6\\u53D1action\\u6267\\u884C\\uFF0C\\u6784\\u5EFA\\u6253\\u5305\\u6211\\u4EEC\\u7684NextJS\\u5E94\\u7528\\u5E76\\u63A8\\u9001\\u5230\",(0,e.jsx)(n.code,{children:\"external_repository\"}),\"\\u5BF9\\u5E94\\u4ED3\\u5E93\\u7684\",(0,e.jsx)(n.code,{children:\"publish_branch\"}),\"\\u5BF9\\u5E94\\u7684\\u5206\\u652F\\u4E2D\"]}),(0,e.jsx)(n.p,{children:\"\\u53EF\\u4EE5\\u5728\\u4ED3\\u5E93\\u7684Actions\\u4E2D\\u67E5\\u770Baction\\u7684\\u6267\\u884C\\u8FC7\\u7A0B\\uFF0C\\u5B8C\\u6210\\u540E\\u6253\\u5F00GitHub Pages\\u5BF9\\u5E94\\u7684\\u4ED3\\u5E93\\u5C31\\u80FD\\u770B\\u5230\\u65B0\\u63D0\\u4EA4\\u7684\\u4EE3\\u7801\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"\",src:\"https://cdn.jsdelivr.net/gh/shimiyzhang/blog-image/images/23-02-26/clipboard-6478.66382d.webp\"})}),(0,e.jsx)(n.p,{children:\"\\u4EE5\\u4E0A\\u5C31\\u662F\\u672C\\u6587\\u7684\\u5168\\u90E8\\u5185\\u5BB9\\uFF0C\\u611F\\u8C22\\u9605\\u8BFB\\u3002\"})]})}function w(a={}){let{wrapper:n}=a.components||{};return n?(0,e.jsx)(n,Object.assign({},a,{children:(0,e.jsx)(p,a)})):p(a)}var f=w;return b(x);})();\n;return Component;"},"_id":"blog/Automatically-deploy-Nextjs-applications-using-Github-Actions.mdx","_raw":{"sourceFilePath":"blog/Automatically-deploy-Nextjs-applications-using-Github-Actions.mdx","sourceFileName":"Automatically-deploy-Nextjs-applications-using-Github-Actions.mdx","sourceFileDir":"blog","contentType":"mdx","flattenedPath":"blog/Automatically-deploy-Nextjs-applications-using-Github-Actions"},"type":"Blog","readingTime":{"text":"4 min read","minutes":3.65,"time":219000,"words":730},"slug":"Automatically-deploy-Nextjs-applications-using-Github-Actions","path":"blog/Automatically-deploy-Nextjs-applications-using-Github-Actions","filePath":"blog/Automatically-deploy-Nextjs-applications-using-Github-Actions.mdx","toc":[]},"authorDetails":[{"name":"木安竹生","avatar":"/static/images/avatar.jpg","occupation":"前端工程师","company":"庐山烟雨浙江潮，未到千般恨不消。","email":"916406821@qq.com","github":"https://github.com/shimiyzhang","juejin":"https://juejin.cn/user/224777950737966","zhihu":"https://www.zhihu.com/people/wo-you-bu-te-bie","type":"Authors","readingTime":{"text":"1 min read","minutes":0.345,"time":20700,"words":69},"slug":"default","path":"authors/default","filePath":"authors/default.mdx","toc":[]}],"prev":{"title":"常用的JavaScript代码片段","date":"2023-02-24T00:00:00.000Z","tags":["JavaScript"],"draft":false,"summary":"列举一下前端开发中常用的JavaScript代码片段，方便今后复习查阅。","type":"Blog","readingTime":{"text":"4 min read","minutes":3.25,"time":195000,"words":650},"slug":"Common-JavaScript-snippets","path":"blog/Common-JavaScript-snippets","filePath":"blog/Common-JavaScript-snippets.mdx","toc":[]},"next":{"title":"二叉树遍历算法","date":"2023-03-06T00:00:00.000Z","tags":["JavaScript","数据结构"],"draft":false,"summary":"对于二叉树，有深度遍历和广度遍历，深度遍历有前序、中序以及后序三种遍历方法，广度遍历即我们平常所说的层次遍历。","type":"Blog","readingTime":{"text":"7 min read","minutes":6.565,"time":393900,"words":1313},"slug":"Traversal-method-of-binary-tree","path":"blog/Traversal-method-of-binary-tree","filePath":"blog/Traversal-method-of-binary-tree.mdx","toc":[]}},"__N_SSG":true}